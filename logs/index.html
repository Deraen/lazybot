<html>
<head>

<script type="text/javascript" src="http://code.jquery.com/jquery-1.4.4.min.js"></script>
<script type="text/javascript">

base_url = "http://lazybot.org/logs/"
log_url  = "http://raynes.me/logs/irc.freenode.net/"
irc_url  = "irc://irc.freenode.net/#"
one_day  = 1000*60*60*24;
hash     = window.location.hash.split("/");
channel  = hash[0].replace("#", "");
current  = hash[1] ? new Date(hash[1].replace(/-/g, "/")) : new Date();

function prev() {
    return new Date(current.getTime() - one_day);
}

function next() {
    return new Date(current.getTime() + one_day);
}

function pad(num) {
    return (num < 10) ? '0' + num : num;
}

function date(t) {
  return t.getFullYear() + "-" + pad(t.getMonth() + 1) + "-" + pad(t.getDate());
}

function updateLog() {
    now = (new Date()).getTime();
    if (current.getTime() > now) {
        current.setTime(now);
    }

    $('#channel').html('<a href="' + irc_url + channel + '">#' + channel + '</a>');
    $('#prev').html('<a href="' + base_url + '#' + channel + '/' + date(prev()) + '">&lt;</a>');
    $('#next').html('<a href="' + base_url + '#' + channel + '/' + date(next()) + '">&gt;</a>');

    day = date(current);
    $('#day').html(day);
    window.location.hash = "#" + channel + "/" + day

    url = log_url + channel + "/" + day + ".txt";
    $.get(url, function(data) {
        $('#log').html(data);
    });
}

$(document).ready(function() {
    $('#log').ajaxError(function() {
        $(this).html("[null] there are no logs available for this date");
    });
    updateLog();
});

</script>

<style type="text/css">
a { text-decoration:none }
a{color: grey;}
a:visited{color: grey;}
</style>

</head>

<body>
<code>
<h3>
<span id="channel"></span>
<span id="prev"></span>
<span id="day"></span>
<span id="next"></span>
</h3>

<pre id="log"></pre>

</code>
</body>
